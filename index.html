<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Storing</title>
</head>
<h1>Lets store a new employee</h1>
<H2>Login Here</H2>
<p id="loginStatus" style="color:red">Not Logged In</p>
    <form id="loginForm">
        <label for="loginUsername">Username:</label>
        <input type="text" id="loginUsername" name="username">
        <br>

        <label for="loginPassword">Password:</label>
        <input type="password" id="loginPassword" name="password">
        <br>

        <input type="submit" value="Login">
    </form> 

<h2>Create New User</h2>
<p>Status:</p>
<p id="status">Not Saved</p>
<body>
    <form id="employeeForm" onsubmit="storeData(event)">
        <label for="fname">First Name</label>
        <input type="text" id="fname" name="fname">
        <br>

        <label for="lname">Last Name</label>
        <input type="text" id="lname" name="lname">
        <br>

        <label for="dept">Department</label>
        <input type="text" id="dept" name="dept">
        <br>

        <label for="salary">Salary</label>
        <input type="text" id="salary" name="salary">
        <br>

        <label for="jobTitle">Job Title</label>
        <input type="text" id="jobTitle" name="jobTitle">
        <br>

        <label for="hireDate">Hire Date</label>
        <input type="date" id="hireDate" name="hireDate">
        <br>

        <label for="endDate">End Date</label>
        <input type="date" id="endDate" name="endDate">
        <br>

        <label for="Username">Username:</label>
        <input type="text" id="Username" name="Username">
        <br>
        
        <label for="Password">Passsword:</label>
        <input type="password" id="Password" name="Password">
        
        <input type="submit" value="Create User">
    </form>
</body>
<script src="index.js"></script>
<script>
    document.getElementById('employeeForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission
  
        let formData = new FormData(this);
  
        fetch('http://localhost:3000/addemployee', {
            method: 'POST',
            body: new URLSearchParams(formData)
        })
        .then(response => response.text())
        .then(data => {
            document.getElementById('status').innerHTML = `<p style="color:green">${data}</p>`
        })
        .catch(error => {
            console.error('Error:', error)
            document.getElementById('status').innerHTML = `<p style="color:red">Failed to save employee</p>`
        });
    });

    document.getElementById('loginForm').addEventListener('submit', function(event) {
        event.preventDefault()

        let formData = new FormData(this)
        console.log('Login form data:', Array.from(formData.entries()))

        fetch('/login', {
            method: 'POST',
            body: new URLSearchParams(formData)
        })

        .then(response => response.json())
        .then(data => {
            console.log('Login response data:', data)

        if (data.success) {
                document.getElementById('loginStatus').innerHTML = `<p style="color:green">Logged In</p>`
            } else {
                document.getElementById('loginStatus').innerHTML = `<p style="color:red">Login Failed</p>`
            }
        })
        .catch(error => {
            console.log('Error:', error)
            document.getElementById('loginStatus').innerHTML = `<p style='color=red'>Login Failed</p>`
        })
    })
  </script>
</html>